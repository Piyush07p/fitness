<!DOCTYPE html>
<html lang="en">

<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>Document</title>
    <link rel="stylesheet" href="css/chat.css">
    <link rel="stylesheet" href="css/home.css">
    
    <link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/6.3.0/css/all.min.css">
</head>

<body>
    <header>
        <nav class="navbar">
            <div class="container">
                <div class="logo">
                    <img  src="images/fit_logo.png" alt="">
                </div>
                <ul class="nav-links">
                    <li><a href="/">Home</a></li>
                    <li><a href="/chat.html">Fit Q&A</a></li>
                    <li><a href="/blogs.html">Blog</a></li>
                    <li><a href="/task.html">Tasks</a></li>
                    <li><a href="/contact.html">Contact</a></li>
                </ul>
            </div>
        </nav>
    </header>
    
    <section class="chat_sec">
        <div class="replyPopup">
            <p class="popPara">0</p>
            <textarea placeholder="enter something.." name=""></textarea><br>
            <button class="popBtn" onclick="removePop()">add</button>
        </div>
        <div>
            <h1>Post your any fitness query here..</h1>
        </div>
        <div class="chat_inp">
            <textarea  id="textInpData"  placeholder="enter your query.."></textarea><br>
            <button class="createBtn">post</button>
        </div>
        <div class="chat_box">

        </div>

    </section>
    <footer>
        <div id="footer-content">

        <div class="footerlogo">
            <img  src="./images/fit_logo.png" alt="logo"> 
            <p>
            <i class="fa-regular fa-copyright" style="color: #b3b3b3;"></i>
            Fit Bucket 2023
            </p>
        </div>

        <div>
            <h3>Useful Links</h3>
            <ul>
                <li><a href="/blogs.html">Blog</a></li>
                <li><a href="/task.html">Tasks</a></li>
                <li><a href="/contact.html">Contact</a></li>
            </ul>
        </div>
       
        </div>
        
    </footer>
</body>
<!-- <script src="js/chat.js"></script> -->
<script src="js/crud.js"></script>
<script src="https://www.gstatic.com/firebasejs/10.4.0/firebase-app.js"></script>

<script src="fireConfig.js"></script>
<script type="module">
    
    import {initializeApp} from "https://www.gstatic.com/firebasejs/10.4.0/firebase-app.js";
    // TODO: Add SDKs for Firebase products that you want to use
    // https://firebase.google.com/docs/web/setup#available-libraries
  
    // Your web app's Firebase configuration
    const firebaseConfig = {
      apiKey: "AIzaSyCXEdHe1CrCLeRQP4cfdw5OwMiXCFafnOY",
      authDomain: "fitnessquery-64b66.firebaseapp.com",
      databaseURL: "https://fitnessquery-64b66-default-rtdb.firebaseio.com",
      projectId: "fitnessquery-64b66",
      storageBucket: "fitnessquery-64b66.appspot.com",
      messagingSenderId: "545468630248",
      appId: "1:545468630248:web:109c35bed1a8c73efd755d"
    };

    
    let createBtn=document.querySelector('.createBtn')
    createBtn.addEventListener('click',insertData)
  
    // Initialize Firebase
    const app = initializeApp(firebaseConfig);

    import {getDatabase,ref,get,set,child,onValue,update,remove} from "https://www.gstatic.com/firebasejs/10.4.0/firebase-database.js";
    const db=getDatabase()

    let query=document.querySelector('#textInpData');
    let fireArray=[]
    function insertData(){
    
        set(ref(db,"queryData/"+fireArray.length),{
            queries:query.value,
        })
        .then(()=>{
            alert("data stored successfully")
        })
        .catch((err)=>{
            alert("error"+err);
        })
        query.value=""
    
    }
    let html=""
    let chatBox=document.querySelector('.chat_box')
    function addQueries(query,ind){
       let newDiv=document.createElement('div')
        html =`
             <div >
                 <div>
                    <p>${query}</p> 
                 </div>
                 <div>
                    <button >Reply</button>
                    <button class="delQueryBtn" onclick="del(${ind})">Delete${ind}</button>
                    </div>
            </div>

        `
        newDiv.classList.add('queryBar')
        newDiv.innerHTML=html
        chatBox.appendChild(newDiv)
        fireArray.push(chatBox.length)
       
    }
    let delQueryBtn=document.querySelectorAll('.delQueryBtn')
     
    function delQuery(){
      alert("he")
        // remove(ref(db,"queryData/"+"kuch bhi"))
        // .then(()=>{
        //     alert("data deleted successfully");

        // })
        // .catch((err)=>{
        //     alert("error:"+err)
        // })
    }


     function AddAllItems(dataArray){
            chatBox.innerHTML="";
            dataArray.forEach(elem=>{
                addQueries(elem.queries,fireArray.length)
            })
     }
    function getAllDataOnce(){
        const dbRef=ref(db);
        get(child(dbRef,"queryData"))
        .then((snap)=>{
            var dataArray=[];
            snap.forEach(childSnap=>{
                dataArray.push(childSnap.val());
            });
            AddAllItems(dataArray);
        })
    }
   function getAlldataRealTime(){
        const dbRef=ref(db,"queryData")
        onValue(dbRef,(snap)=>{
            var dataArray=[];
            snap.forEach(childSnap=>{
                dataArray.push(childSnap.val());
            })
            AddAllItems(dataArray);
        })
    }
  window.onload=getAlldataRealTime;

  </script>

</html>